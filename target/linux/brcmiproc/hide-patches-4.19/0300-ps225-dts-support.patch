--- /dev/null
+++ b/arch/arm64/boot/dts/broadcom/stingray/bcm958802a804x.dts
@@ -0,0 +1,31 @@
+// SPDX-License-Identifier: (GPL-2.0 or BSD-3-Clause)
+/*
+ *  Copyright(c) 2018 Broadcom
+ */
+
+/dts-v1/;
+
+#define NUM_CRYPTO	32
+#define NUM_RAID	0
+#define ENABLE_ENET	0
+#define ENABLE_MDIO	0
+#define ENABLE_USB1	0
+#define NUM_PAXB	0
+
+#include "stingray-board-base.dtsi"
+
+/ {
+	model = "Stingray PS225xx (BCM958802A804x)";
+
+	chosen {
+		stdout-path = "serial1:115200n8";
+	};
+};
+
+&sdio0 {
+	no-1-8-v;
+};
+
+&uart0 {
+	status = "okay";
+};
--- /dev/null
+++ b/arch/arm64/boot/dts/broadcom/stingray/bcm958804a8040.dts
@@ -0,0 +1,60 @@
+/*
+ *  BSD LICENSE
+ *
+ *  Copyright(c) 2017 Broadcom.  All rights reserved.
+ *
+ *  Redistribution and use in source and binary forms, with or without
+ *  modification, are permitted provided that the following conditions
+ *  are met:
+ *
+ *    * Redistributions of source code must retain the above copyright
+ *      notice, this list of conditions and the following disclaimer.
+ *    * Redistributions in binary form must reproduce the above copyright
+ *      notice, this list of conditions and the following disclaimer in
+ *      the documentation and/or other materials provided with the
+ *      distribution.
+ *    * Neither the name of Broadcom nor the names of its
+ *      contributors may be used to endorse or promote products derived
+ *      from this software without specific prior written permission.
+ *
+ *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+ *  "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+ *  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
+ *  A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
+ *  OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ *  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
+ *  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
+ *  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
+ *  THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ *  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+ *  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ */
+
+/dts-v1/;
+
+#define NUM_CRYPTO	32
+#define NUM_RAID	8
+#define ENABLE_I2C0	1
+#define ENABLE_USB1	0
+
+/ {
+	model = "Stingray PS1100R (BCM958804A8040)";
+};
+
+#include "stingray-board-base.dtsi"
+
+&sdio0 {
+	no-1-8-v;
+};
+
+&gphy0 {
+	reg = <0x0>;
+};
+
+&i2c0 {
+	thermal: thermal@4c {
+		compatible = "national,lm90";
+		reg = <0x4c>;
+		#thermal-sensor-cells = <1>;
+	};
+};
--- a/arch/arm64/boot/dts/broadcom/stingray/stingray-board-base.dtsi
+++ b/arch/arm64/boot/dts/broadcom/stingray/stingray-board-base.dtsi
@@ -3,9 +3,54 @@
  *  Copyright(c) 2016-2018 Broadcom
  */

+#ifndef ENABLE_EMMC
+#define ENABLE_EMMC	1
+#endif
+
+#ifndef ENABLE_ENET
+#define ENABLE_ENET	1
+#endif
+
+#ifndef ENABLE_MDIO
+#define ENABLE_MDIO	1
+#endif
+
+#ifndef ENABLE_NAND
+#define ENABLE_NAND	0
+#endif
+
+#ifndef ENABLE_PAXC
+#define ENABLE_PAXC	1
+#endif
+
+#ifndef ENABLE_PWM
+#define ENABLE_PWM	0
+#endif
+
+#ifndef ENABLE_SDCARD
+#define ENABLE_SDCARD	0
+#endif
+
+#ifndef ENABLE_USB0
+#define ENABLE_USB0	1
+#endif
+
+#ifndef ENABLE_USB1
+#define ENABLE_USB1	1
+#endif
+
+#ifndef NUM_PAXB
+#define NUM_PAXB	8
+#endif
+
 #include "stingray.dtsi"
 #include <dt-bindings/gpio/gpio.h>

+#define PCIE_DMA_RANGES dma-ranges = < \
+	0x43000000 0x00 0x80000000 0x00 0x80000000 0x00 0x80000000 \
+	0x43000000 0x08 0x00000000 0x08 0x00000000 0x08 0x00000000 \
+	0x43000000 0x80 0x00000000 0x80 0x00000000 0x80 0x00000000>
+
 / {
 	aliases {
 		serial0 = &uart1;
@@ -17,6 +62,43 @@
 	chosen {
 		stdout-path = "serial0:115200n8";
 	};
+
+	reserved-memory {
+		#address-cells = <2>;
+		#size-cells = <2>;
+		ranges;
+
+#if (ENABLE_PAXC_IOMMU == 0)
+/*
+ * When standard IOMMU is disabled for PAXC, one needs to enable IOMMU
+ * identity mapping for PAXC on SR A2. In this case, below DDR region
+ * needs to be reserved for SMMU map table created for identity mapping.
+ */
+		smmu_pg_region {
+			reg = <0x8 0x80200000 0x0 0x200000>;
+			no-map;
+		};
+#endif
+		pci_lpm_region: pci_lpm_region@801f0000 {
+			reg = <0x0 0x8f101000 0x0 0x1000>;
+			no-map;
+		};
+	};
+
+	nvme_lpm: nvme_lpm {
+		compatible = "simple-bus";
+		#address-cells = <1>;
+		#size-cells = <1>;
+		ranges = <0x0 0x0 0x8f100100 0x100>;
+		status = "disabled";
+		nvme_lpm_data_backup: nvme-lpm-data-backup@14 {
+			compatible = "brcm,nvme-lpm-data-backup";
+			reg = <0x0 0x100>;
+			intrpt-gpio = <&gpio_hsls 2 GPIO_ACTIVE_HIGH>;
+			mboxes = <&mailbox 0>;
+			memory-region = <&pci_lpm_region>;
+		};
+	};
 };

 &memory { /* Default DRAM banks */
@@ -24,28 +106,155 @@
 	      <0x00000008 0x80000000 0x1 0x80000000>; /* 6G @ 34G */
 };

+&pcie0 {
+	PCIE_DMA_RANGES;
+};
+
+&pcie1 {
+	PCIE_DMA_RANGES;
+};
+
+&pcie2 {
+	PCIE_DMA_RANGES;
+};
+
+&pcie3 {
+	PCIE_DMA_RANGES;
+};
+
+&pcie4 {
+	PCIE_DMA_RANGES;
+};
+
+&pcie5 {
+	PCIE_DMA_RANGES;
+};
+
+&pcie6 {
+	PCIE_DMA_RANGES;
+};
+
+&pcie7 {
+	PCIE_DMA_RANGES;
+};
+
 &enet {
 	phy-mode = "rgmii-id";
 	phy-handle = <&gphy0>;
+#if (ENABLE_ENET == 1)
+	status = "okay";
+#endif
 };

 &uart1 {
 	status = "okay";
 };

+&uart2 {
+#if (ENABLE_UART2 == 1)
+	status = "okay";
+#endif
+};
+
+&uart3 {
+#if (ENABLE_UART3 == 1)
+	status = "okay";
+#endif
+};
+
 &sdio0 {
+#if (ENABLE_EMMC == 1)
 	non-removable;
 	full-pwr-cycle;
+	status = "okay";
+#endif
 };

 &sdio1 {
+#if (ENABLE_SDCARD == 1)
 	full-pwr-cycle;
+	status = "okay";
+#endif
+};
+
+&pwm {
+#if (ENABLE_PWM == 1)
+	status = "okay";
+#endif
+};
+
+&ssp0 {
+	cs-gpios = <&gpio_hsls 34 0>;
+#if (ENABLE_SSP0 == 1)
+	status = "okay";
+#endif
+};
+
+&ssp1 {
+	cs-gpios = <&gpio_hsls 96 0>;
+#if (ENABLE_SSP1 == 1)
+	status = "okay";
+#endif
+};
+
+&i2c0 {
+#if (ENABLE_I2C0 == 1)
+	status = "okay";
+#endif
+};
+
+&i2c1 {
+#if (ENABLE_I2C1 == 1)
+	status = "okay";
+#endif
 };

 &mdio_mux_iproc {
+#if (ENABLE_MDIO == 1)
+	status = "okay";
+#endif
+	mdio@2 { /* SATA */
+#if (NUM_SATA > 0)
+		status = "okay";
+#endif
+	};
+
 	mdio@10 {
+#if (ENABLE_ENET == 1)
+		status = "okay";
+#endif
 		gphy0: eth-phy@10 {
 			reg = <0x10>;
 		};
 	};
 };
+
+&nand {
+#if (ENABLE_NAND == 1)
+	status = "ok";
+#endif
+};
+
+&qspi {
+	pinctrl-names = "default";
+	pinctrl-0 = <&qspi_pins>;
+	bspi-sel = <0>;
+/* reserve QSPI for Chimp NVRAM when PAXC is enabled */
+#if (ENABLE_PAXC != 1)
+	status = "okay";
+#endif
+
+	flash: w25q64@0 {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		compatible = "jedec,spi-nor";
+		reg = <0x0>;
+		spi-max-frequency = <12500000>;
+	};
+};
+
+&rtc {
+#if (ENABLE_RTC == 1)
+	status = "okay";
+#endif
+};
--- a/arch/arm64/boot/dts/broadcom/stingray/stingray.dtsi
+++ b/arch/arm64/boot/dts/broadcom/stingray/stingray.dtsi
@@ -32,11 +32,20 @@

 #include <dt-bindings/interrupt-controller/arm-gic.h>

+#ifndef ENABLE_PAXB_IOMMU
+#define ENABLE_PAXB_IOMMU	0
+#endif
+
+#ifndef ENABLE_IHOST12_CPUS
+#define ENABLE_IHOST12_CPUS	1
+#endif
+
 / {
 	compatible = "brcm,stingray";
 	interrupt-parent = <&gic>;
 	#address-cells = <2>;
 	#size-cells = <2>;
+	dma-ranges = <0x0 0x0 0x0 0x0 0x100 0x0>;

 	cpus {
 		#address-cells = <2>;
@@ -47,6 +56,12 @@
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x0 0x0>;
 			enable-method = "psci";
+			i-cache-size = <0xc000>;
+			i-cache-line-size = <64>;
+			i-cache-sets = <256>;
+			d-cache-size = <0x8000>;
+			d-cache-line-size = <64>;
+			d-cache-sets = <256>;
 			next-level-cache = <&CLUSTER0_L2>;
 		};

@@ -55,14 +70,26 @@
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x0 0x1>;
 			enable-method = "psci";
+			i-cache-size = <0xc000>;
+			i-cache-line-size = <64>;
+			i-cache-sets = <256>;
+			d-cache-size = <0x8000>;
+			d-cache-line-size = <64>;
+			d-cache-sets = <256>;
 			next-level-cache = <&CLUSTER0_L2>;
 		};
-
+#if (ENABLE_IHOST12_CPUS == 1)
 		cpu@100 {
 			device_type = "cpu";
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x0 0x100>;
 			enable-method = "psci";
+			i-cache-size = <0xc000>;
+			i-cache-line-size = <64>;
+			i-cache-sets = <256>;
+			d-cache-size = <0x8000>;
+			d-cache-line-size = <64>;
+			d-cache-sets = <256>;
 			next-level-cache = <&CLUSTER1_L2>;
 		};

@@ -71,6 +98,12 @@
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x0 0x101>;
 			enable-method = "psci";
+			i-cache-size = <0xc000>;
+			i-cache-line-size = <64>;
+			i-cache-sets = <256>;
+			d-cache-size = <0x8000>;
+			d-cache-line-size = <64>;
+			d-cache-sets = <256>;
 			next-level-cache = <&CLUSTER1_L2>;
 		};

@@ -79,6 +112,12 @@
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x0 0x200>;
 			enable-method = "psci";
+			i-cache-size = <0xc000>;
+			i-cache-line-size = <64>;
+			i-cache-sets = <256>;
+			d-cache-size = <0x8000>;
+			d-cache-line-size = <64>;
+			d-cache-sets = <256>;
 			next-level-cache = <&CLUSTER2_L2>;
 		};

@@ -87,14 +126,26 @@
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x0 0x201>;
 			enable-method = "psci";
+			i-cache-size = <0xc000>;
+			i-cache-line-size = <64>;
+			i-cache-sets = <256>;
+			d-cache-size = <0x8000>;
+			d-cache-line-size = <64>;
+			d-cache-sets = <256>;
 			next-level-cache = <&CLUSTER2_L2>;
 		};
-
+#endif
 		cpu@300 {
 			device_type = "cpu";
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x0 0x300>;
 			enable-method = "psci";
+			i-cache-size = <0xc000>;
+			i-cache-line-size = <64>;
+			i-cache-sets = <256>;
+			d-cache-size = <0x8000>;
+			d-cache-line-size = <64>;
+			d-cache-sets = <256>;
 			next-level-cache = <&CLUSTER3_L2>;
 		};

@@ -103,23 +154,41 @@
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x0 0x301>;
 			enable-method = "psci";
+			i-cache-size = <0xc000>;
+			i-cache-line-size = <64>;
+			i-cache-sets = <256>;
+			d-cache-size = <0x8000>;
+			d-cache-line-size = <64>;
+			d-cache-sets = <256>;
 			next-level-cache = <&CLUSTER3_L2>;
 		};

 		CLUSTER0_L2: l2-cache@0 {
 			compatible = "cache";
+			cache-size = <0x200000>;
+			cache-line-size = <64>;
+			cache-sets = <2048>;
 		};
-
+#if (ENABLE_IHOST12_CPUS == 1)
 		CLUSTER1_L2: l2-cache@100 {
 			compatible = "cache";
+			cache-size = <0x200000>;
+			cache-line-size = <64>;
+			cache-sets = <2048>;
 		};

 		CLUSTER2_L2: l2-cache@200 {
 			compatible = "cache";
+			cache-size = <0x200000>;
+			cache-line-size = <64>;
+			cache-sets = <2048>;
 		};
-
+#endif
 		CLUSTER3_L2: l2-cache@300 {
 			compatible = "cache";
+			cache-size = <0x200000>;
+			cache-line-size = <64>;
+			cache-sets = <2048>;
 		};
 	};

@@ -146,6 +215,8 @@
 			     <GIC_PPI 10 IRQ_TYPE_LEVEL_LOW>;
 	};

+	#include "stingray-pcie.dtsi"
+
 	mhb: syscon@60401000 {
 		compatible = "brcm,sr-mhb", "syscon";
 		reg = <0 0x60401000 0 0x38c>;
@@ -186,6 +257,14 @@
 			compatible = "arm,mmu-500";
 			reg = <0x03000000 0x80000>;
 			#global-interrupts = <1>;
+			/* reserve gic-its (@63c20000 + its translater) */
+			#region-address-cells = <1>;
+			#region-size-cells = <1>;
+			reserved-msi-region = <0x0 0x1a 0x63c30000 0x8000>;
+#if (ENABLE_PAXC_IOMMU == 0)
+			reserved-context-banks = <1>;
+			reserved-mapping-groups = <8>;
+#endif
 			interrupts = <GIC_SPI 704 IRQ_TYPE_LEVEL_HIGH>,
 				     <GIC_SPI 711 IRQ_TYPE_LEVEL_HIGH>,
 				     <GIC_SPI 712 IRQ_TYPE_LEVEL_HIGH>,
@@ -248,9 +327,11 @@
 				     <GIC_SPI 769 IRQ_TYPE_LEVEL_HIGH>,
 				     <GIC_SPI 770 IRQ_TYPE_LEVEL_HIGH>,
 				     <GIC_SPI 771 IRQ_TYPE_LEVEL_HIGH>,
-				     <GIC_SPI 772 IRQ_TYPE_LEVEL_HIGH>,
-				     <GIC_SPI 773 IRQ_TYPE_LEVEL_HIGH>,
-				     <GIC_SPI 774 IRQ_TYPE_LEVEL_HIGH>;
+				     <GIC_SPI 772 IRQ_TYPE_LEVEL_HIGH>
+#if (ENABLE_PAXC_IOMMU == 1)
+				     ,<GIC_SPI 773 IRQ_TYPE_LEVEL_HIGH>
+#endif
+					;
 			#iommu-cells = <2>;
 		};
 	};
@@ -275,6 +356,12 @@
 			reg = <0x0001d000 0x400>;
 		};

+		mailbox: mailbox@24024 {
+			compatible = "brcm,iproc-mailbox";
+			reg = <0x00024024 0x8>;
+			#mbox-cells = <1>;
+		};
+
 		gpio_crmu: gpio@24800 {
 			compatible = "brcm,iproc-gpio";
 			reg = <0x00024800 0x4c>;
@@ -286,10 +373,10 @@

 	#include "stingray-fs4.dtsi"
 	#include "stingray-sata.dtsi"
-	#include "stingray-pcie.dtsi"

 	hsls {
 		compatible = "simple-bus";
+		dma-ranges;
 		#address-cells = <1>;
 		#size-cells = <1>;
 		ranges = <0x0 0x0 0x68900000 0x17700000>;
@@ -301,29 +390,20 @@
 			reg = <0x00020000 0x250>;
 			#address-cells = <1>;
 			#size-cells = <0>;
-
-			mdio@0 { /* PCIe serdes */
-				reg = <0x0>;
-				#address-cells = <1>;
-				#size-cells = <0>;
-			};
+			status = "disabled";

 			mdio@2 { /* SATA */
 				reg = <0x2>;
 				#address-cells = <1>;
 				#size-cells = <0>;
+				status = "disabled";
 			};

-			mdio@3 { /* USB */
-				reg = <0x3>;
-				#address-cells = <1>;
-				#size-cells = <0>;
-			};
-
-			mdio@10 { /* RGMII */
+			mdio@10 { /* SGMII */
 				reg = <0x10>;
 				#address-cells = <1>;
 				#size-cells = <0>;
+				status = "disabled";
 			};
 		};

@@ -335,6 +415,7 @@
 			status = "disabled";
 		};

+		/* Don't use this timer it is being used by ATF */
 		timer0: timer@30000 {
 			compatible = "arm,sp804", "arm,primecell";
 			reg = <0x00030000 0x1000>;
@@ -448,6 +529,7 @@
 			#gpio-cells = <2>;
 			gpio-controller;
 			interrupt-controller;
+			#interrupt-cells = <2>;
 			interrupts = <GIC_SPI 183 IRQ_TYPE_LEVEL_HIGH>;
 			gpio-ranges = <&pinmux 0 0 16>,
 					<&pinmux 16 71 2>,
@@ -463,7 +545,8 @@
 					<&pinmux 108 16 27>,
 					<&pinmux 135 77 6>,
 					<&pinmux 141 67 4>,
-					<&pinmux 145 149 6>;
+					<&pinmux 145 149 6>,
+					<&pinmux 151 91 4>;
 		};

 		i2c1: i2c@e0000 {
@@ -591,6 +674,26 @@
 			status = "disabled";
 		};

+		qspi: spi@370200 {
+			compatible = "brcm,spi-iproc-qspi-v1",
+				     "brcm,spi-bcm-qspi";
+			reg = <0x00370200 0x184>,
+				<0x00370000 0x124>,
+				<0x0050c408 0x004>,
+				<0x003703a0 0x01c>;
+			reg-names = "mspi", "bspi", "intr_regs",
+				"intr_status_reg";
+			interrupts = <GIC_SPI 202 IRQ_TYPE_LEVEL_HIGH>;
+			interrupt-names = "spi_l1_intr";
+			clocks = <&hsls_div4_clk>;
+			clock-names = "qspi_clk";
+			clock-frequency = <175000000>;
+			num-cs = <2>;
+			#address-cells = <1>;
+			#size-cells = <0>;
+			status = "disabled";
+		};
+
 		sdio0: sdhci@3f1000 {
 			compatible = "brcm,sdhci-iproc";
 			reg = <0x003f1000 0x100>;
@@ -611,4 +714,121 @@
 			status = "disabled";
 		};
 	};
+
+	rtc: rtc {
+		compatible = "brcm,iproc-rtc";
+		interrupts = <GIC_SPI 219 IRQ_TYPE_EDGE_RISING>;
+		status = "disabled";
+	};
+
+	tmons {
+		compatible = "simple-bus";
+		#address-cells = <1>;
+		#size-cells = <1>;
+		ranges = <0x0 0x0 0x8f100000 0x100>;
+
+		tmon: tmon@0 {
+			compatible = "brcm,sr-thermal";
+			reg = <0x0 0x40>;
+			brcm,tmon-mask = <0x3f>;
+			#thermal-sensor-cells = <1>;
+		};
+	};
+
+	thermal-zones {
+		ihost0_thermal: ihost0-thermal {
+			polling-delay-passive = <0>;
+			polling-delay = <1000>;
+			thermal-sensors = <&tmon 0>;
+			trips {
+				cpu-crit {
+					temperature = <105000>;
+					hysteresis = <0>;
+					type = "critical";
+				};
+			};
+		};
+
+		ihost1_thermal: ihost1-thermal {
+			polling-delay-passive = <0>;
+			polling-delay = <1000>;
+			thermal-sensors = <&tmon 1>;
+			trips {
+				cpu-crit {
+					temperature = <105000>;
+					hysteresis = <0>;
+					type = "critical";
+				};
+			};
+		};
+
+		ihost2_thermal: ihost2-thermal {
+			polling-delay-passive = <0>;
+			polling-delay = <1000>;
+			thermal-sensors = <&tmon 2>;
+			trips {
+				cpu-crit {
+					temperature = <105000>;
+					hysteresis = <0>;
+					type = "critical";
+				};
+			};
+		};
+
+		ihost3_thermal: ihost3-thermal {
+			polling-delay-passive = <0>;
+			polling-delay = <1000>;
+			thermal-sensors = <&tmon 3>;
+			trips {
+				cpu-crit {
+					temperature = <105000>;
+					hysteresis = <0>;
+					type = "critical";
+				};
+			};
+		};
+
+		crmu_thermal: crmu-thermal {
+			polling-delay-passive = <0>;
+			polling-delay = <1000>;
+			thermal-sensors = <&tmon 4>;
+			trips {
+				cpu-crit {
+					temperature = <105000>;
+					hysteresis = <0>;
+					type = "critical";
+				};
+			};
+		};
+
+		nitro_thermal: nitro-thermal {
+			polling-delay-passive = <0>;
+			polling-delay = <1000>;
+			thermal-sensors = <&tmon 5>;
+			trips {
+				cpu-crit {
+					temperature = <105000>;
+					hysteresis = <0>;
+					type = "critical";
+				};
+			};
+		};
+	};
+
+	nic-hsls {
+		compatible = "simple-bus";
+		#address-cells = <1>;
+		#size-cells = <1>;
+		ranges = <0x0 0x0  0x0 0xffffffff>;
+
+		nic_i2c0: i2c@60826100 {
+			compatible = "brcm,iproc-nic-i2c";
+			reg = <0x60826100 0x100>,
+			      <0x60e00408 0x1000>;
+			brcm,ape-hsls-addr-mask = <0x03400000>;
+			clock-frequency = <100000>;
+			status = "disabled";
+		};
+	};
 };
+
--- a/arch/arm64/boot/dts/broadcom/stingray/stingray-pcie.dtsi
+++ b/arch/arm64/boot/dts/broadcom/stingray/stingray-pcie.dtsi
@@ -3,40 +3,480 @@
  *Copyright(c) 2018 Broadcom
  */

-pcie8: pcie@60400000 {
-	compatible = "brcm,iproc-pcie-paxc-v2";
-	reg = <0 0x60400000 0 0x1000>;
-	linux,pci-domain = <8>;
-
-	bus-range = <0x0 0x1>;
-
-	#address-cells = <3>;
-	#size-cells = <2>;
-	device_type = "pci";
-	ranges = <0x83000000 0 0x10000000 0 0x10000000 0 0x20000000>;
-
-	dma-coherent;
-
-	msi-map = <0x100 &gic_its 0x2000 0x1>, /* PF0 */
-		  <0x108 &gic_its 0x2040 0x8>, /* PF0-VF0-7 */
-		  <0x101 &gic_its 0x2080 0x1>, /* PF1 */
-		  <0x110 &gic_its 0x20c8 0x8>, /* PF1-VF8-15 */
-		  <0x102 &gic_its 0x2100 0x1>, /* PF2 */
-		  <0x118 &gic_its 0x2150 0x8>, /* PF2-VF16-23 */
-		  <0x103 &gic_its 0x2180 0x1>, /* PF3 */
-		  <0x120 &gic_its 0x21d8 0x8>, /* PF3-VF24-31 */
-		  <0x104 &gic_its 0x2200 0x1>, /* PF4 */
-		  <0x128 &gic_its 0x2260 0x8>, /* PF4-VF32-39 */
-		  <0x105 &gic_its 0x2280 0x1>, /* PF5 */
-		  <0x130 &gic_its 0x22e8 0x8>, /* PF5-VF40-47 */
-		  <0x106 &gic_its 0x2300 0x1>, /* PF6 */
-		  <0x138 &gic_its 0x2370 0x8>, /* PF6-VF48-55 */
-		  <0x107 &gic_its 0x2380 0x1>, /* PF7 */
-		  <0x140 &gic_its 0x23f8 0x8>; /* PF7-VF56-63 */
-
-	phys = <&pcie_phy 8>;
-	phy-names = "pcie-phy";
-};
+#if (NUM_PAXB == 8)
+#define ENABLE_PCIE0	1
+#define ENABLE_PCIE1	1
+#define ENABLE_PCIE2	1
+#define ENABLE_PCIE3	1
+#define ENABLE_PCIE4	1
+#define ENABLE_PCIE5	1
+#define ENABLE_PCIE6	1
+#define ENABLE_PCIE7	1
+#endif
+
+#if (NUM_PAXB == 1)
+#define ENABLE_PCIE1	1
+#endif
+
+	pcie0: pcie@48000000 {
+		compatible = "brcm,iproc-pcie-paxb-v2";
+		reg = <0 0x48000000 0 0x4000>;
+
+		interrupt-controller;
+		#interrupt-cells = <1>;
+		interrupt-map-mask = <0 0 0 7>;
+		interrupt-map = <0 0 0 0 1 &pcie0 1>,
+				<0 0 0 0 2 &pcie0 2>,
+				<0 0 0 0 3 &pcie0 3>,
+				<0 0 0 0 4 &pcie0 4>;
+		interrupts = <GIC_SPI 420 IRQ_TYPE_LEVEL_HIGH>;
+
+		linux,pci-domain = <0>;
+
+		bus-range = <0x0 0xff>;
+
+		#address-cells = <3>;
+		#size-cells = <2>;
+		device_type = "pci";
+#if (ENABLE_32BIT_OUTBOUND == 1)
+		ranges = <0x83000000 0x0 0x42000000 0x0 0x42000000 0 0x2000000>,
+			 <0x43000000 0x4 0x00000000 0x4 0x00000000 0 0x80000000>;
+#else
+		ranges = <0x43000000 0x4 0x00000000 0x4 0x00000000 0 0x40000000>,
+			 <0x43000000 0x4 0x40000000 0x4 0x40000000 0 0x20000000>,
+			 <0x43000000 0x4 0x60000000 0x4 0x60000000 0 0x10000000>,
+			 <0x83000000 0x0 0x40000000 0x4 0x70000000 0 0x10000000>;
+#endif
+		brcm,pcie-ob;
+		brcm,pcie-ob-axi-offset = <0x00000000>;
+
+		dma-coherent;
+
+		msi-map = <0x000 &gic_its 0x000 0x400>;
+
+#if (ENABLE_PAXB_IOMMU == 1)
+		iommu-map = <0x000 &smmu 0x000 0x400>;
+#endif
+
+		phys = <&pcie_phy 0>;
+		phy-names = "pcie-phy";
+
+#if (ENABLE_PCIE0 == 1)
+		status = "okay";
+#else
+		status = "disabled";
+#endif
+	};
+
+	pcie1: pcie@48004000 {
+		compatible = "brcm,iproc-pcie-paxb-v2";
+		reg = <0 0x48004000 0 0x4000>;
+
+		interrupt-controller;
+		#interrupt-cells = <1>;
+		interrupt-map-mask = <0 0 0 7>;
+		interrupt-map = <0 0 0 0 1 &pcie1 1>,
+				<0 0 0 0 2 &pcie1 2>,
+				<0 0 0 0 3 &pcie1 3>,
+				<0 0 0 0 4 &pcie1 4>;
+		interrupts = <GIC_SPI 426 IRQ_TYPE_LEVEL_HIGH>;
+
+		linux,pci-domain = <1>;
+
+		bus-range = <0x0 0xff>;
+
+		#address-cells = <3>;
+		#size-cells = <2>;
+		device_type = "pci";
+#if (ENABLE_32BIT_OUTBOUND == 1)
+		ranges = <0x83000000 0x0 0x44000000 0x0 0x44000000 0 0x2000000>,
+			 <0x43000000 0x4 0x80000000 0x4 0x80000000 0 0x80000000>;
+#else
+		ranges = <0x43000000 0x4 0x80000000 0x4 0x80000000 0 0x40000000>,
+			 <0x43000000 0x4 0xc0000000 0x4 0xc0000000 0 0x20000000>,
+			 <0x43000000 0x4 0xe0000000 0x4 0xe0000000 0 0x10000000>,
+			 <0x83000000 0x0 0x40000000 0x4 0xf0000000 0 0x10000000>;
+#endif
+		brcm,pcie-ob;
+		brcm,pcie-ob-axi-offset = <0x00000000>;
+
+		dma-coherent;
+
+		msi-map = <0x000 &gic_its 0x400 0x400>;
+
+#if (ENABLE_PAXB_IOMMU == 1)
+		iommu-map = <0x000 &smmu 0x400 0x400>;
+#endif
+
+		phys = <&pcie_phy 1>;
+		phy-names = "pcie-phy";
+
+#if (ENABLE_PCIE1 == 1)
+		status = "okay";
+#else
+		status = "disabled";
+#endif
+	};
+
+	pcie2: pcie@48008000 {
+		compatible = "brcm,iproc-pcie-paxb-v2";
+		reg = <0 0x48008000 0 0x4000>;
+
+		interrupt-controller;
+		#interrupt-cells = <1>;
+		interrupt-map-mask = <0 0 0 7>;
+		interrupt-map = <0 0 0 0 1 &pcie2 1>,
+				<0 0 0 0 2 &pcie2 2>,
+				<0 0 0 0 3 &pcie2 3>,
+				<0 0 0 0 4 &pcie2 4>;
+		interrupts = <GIC_SPI 432 IRQ_TYPE_LEVEL_HIGH>;
+
+		linux,pci-domain = <2>;
+
+		bus-range = <0x0 0xff>;
+
+		#address-cells = <3>;
+		#size-cells = <2>;
+		device_type = "pci";
+#if (ENABLE_32BIT_OUTBOUND == 1)
+		ranges = <0x83000000 0x0 0x4a000000 0x0 0x4a000000 0 0x2000000>,
+			 <0x43000000 0x5 0x00000000 0x5 0x00000000 0 0x80000000>;
+#else
+		ranges = <0x43000000 0x5 0x00000000 0x5 0x00000000 0 0x40000000>,
+			 <0x43000000 0x5 0x40000000 0x5 0x40000000 0 0x20000000>,
+			 <0x43000000 0x5 0x60000000 0x5 0x60000000 0 0x10000000>,
+			 <0x83000000 0x0 0x40000000 0x5 0x70000000 0 0x10000000>;
+#endif
+		brcm,pcie-ob;
+		brcm,pcie-ob-axi-offset = <0x00000000>;
+
+		dma-coherent;
+
+		msi-map = <0x000 &gic_its 0x800 0x400>;
+
+#if (ENABLE_PAXB_IOMMU == 1)
+		iommu-map = <0x000 &smmu 0x800 0x400>;
+#endif
+
+		phys = <&pcie_phy 2>;
+		phy-names = "pcie-phy";
+
+#if (ENABLE_PCIE2 == 1)
+		status = "okay";
+#else
+		status = "disabled";
+#endif
+	};
+
+	pcie3: pcie@4800c000 {
+		compatible = "brcm,iproc-pcie-paxb-v2";
+		reg = <0 0x4800c000 0 0x4000>;
+
+		interrupt-controller;
+		#interrupt-cells = <1>;
+		interrupt-map-mask = <0 0 0 7>;
+		interrupt-map = <0 0 0 0 1 &pcie3 1>,
+				<0 0 0 0 2 &pcie3 2>,
+				<0 0 0 0 3 &pcie3 3>,
+				<0 0 0 0 4 &pcie3 4>;
+		interrupts = <GIC_SPI 438 IRQ_TYPE_LEVEL_HIGH>;
+
+		linux,pci-domain = <3>;
+
+		bus-range = <0x0 0xff>;
+
+		#address-cells = <3>;
+		#size-cells = <2>;
+		device_type = "pci";
+#if (ENABLE_32BIT_OUTBOUND == 1)
+		ranges = <0x83000000 0x0 0x4c000000 0x0 0x4c000000 0 0x2000000>,
+			 <0x43000000 0x5 0x80000000 0x5 0x80000000 0 0x80000000>;
+#else
+		ranges = <0x43000000 0x5 0x80000000 0x5 0x80000000 0 0x40000000>,
+			 <0x43000000 0x5 0xc0000000 0x5 0xc0000000 0 0x20000000>,
+			 <0x43000000 0x5 0xe0000000 0x5 0xe0000000 0 0x10000000>,
+			 <0x83000000 0x0 0x40000000 0x5 0xf0000000 0 0x10000000>;
+#endif
+		brcm,pcie-ob;
+		brcm,pcie-ob-axi-offset = <0x00000000>;
+
+		dma-coherent;
+
+		msi-map = <0x000 &gic_its 0xc00 0x400>;
+
+#if (ENABLE_PAXB_IOMMU == 1)
+		iommu-map = <0x000 &smmu 0xc00 0x400>;
+#endif
+
+		phys = <&pcie_phy 3>;
+		phy-names = "pcie-phy";
+
+#if (ENABLE_PCIE3 == 1)
+		status = "okay";
+#else
+		status = "disabled";
+#endif
+	};
+
+	pcie4: pcie@48010000 {
+		compatible = "brcm,iproc-pcie-paxb-v2";
+		reg = <0 0x48010000 0 0x4000>;
+
+		interrupt-controller;
+		#interrupt-cells = <1>;
+		interrupt-map-mask = <0 0 0 7>;
+		interrupt-map = <0 0 0 0 1 &pcie4 1>,
+				<0 0 0 0 2 &pcie4 2>,
+				<0 0 0 0 3 &pcie4 3>,
+				<0 0 0 0 4 &pcie4 4>;
+		interrupts = <GIC_SPI 444 IRQ_TYPE_LEVEL_HIGH>;
+
+		linux,pci-domain = <4>;
+
+		bus-range = <0x0 0xff>;
+
+		#address-cells = <3>;
+		#size-cells = <2>;
+		device_type = "pci";
+#if (ENABLE_32BIT_OUTBOUND == 1)
+		ranges = <0x83000000 0x0 0x52000000 0x0 0x52000000 0 0x2000000>,
+			 <0x43000000 0x6 0x00000000 0x6 0x00000000 0 0x80000000>;
+#else
+		ranges = <0x43000000 0x6 0x00000000 0x6 0x00000000 0 0x40000000>,
+			 <0x43000000 0x6 0x40000000 0x6 0x40000000 0 0x20000000>,
+			 <0x43000000 0x6 0x60000000 0x6 0x60000000 0 0x10000000>,
+			 <0x83000000 0x0 0x40000000 0x6 0x70000000 0 0x10000000>;
+#endif
+		brcm,pcie-ob;
+		brcm,pcie-ob-axi-offset = <0x00000000>;
+
+		dma-coherent;
+
+		msi-map = <0x000 &gic_its 0x1000 0x400>;
+
+#if (ENABLE_PAXB_IOMMU == 1)
+		iommu-map = <0x000 &smmu 0x1000 0x400>;
+#endif
+
+		phys = <&pcie_phy 4>;
+		phy-names = "pcie-phy";
+
+#if (ENABLE_PCIE4 == 1)
+		status = "okay";
+#else
+		status = "disabled";
+#endif
+	};
+
+	pcie5: pcie@48014000 {
+		compatible = "brcm,iproc-pcie-paxb-v2";
+		reg = <0 0x48014000 0 0x4000>;
+
+		interrupt-controller;
+		#interrupt-cells = <1>;
+		interrupt-map-mask = <0 0 0 7>;
+		interrupt-map = <0 0 0 0 1 &pcie5 1>,
+				<0 0 0 0 2 &pcie5 2>,
+				<0 0 0 0 3 &pcie5 3>,
+				<0 0 0 0 4 &pcie5 4>;
+		interrupts = <GIC_SPI 450 IRQ_TYPE_LEVEL_HIGH>;
+
+		linux,pci-domain = <5>;
+
+		bus-range = <0x0 0xff>;
+
+		#address-cells = <3>;
+		#size-cells = <2>;
+		device_type = "pci";
+#if (ENABLE_32BIT_OUTBOUND == 1)
+		ranges = <0x83000000 0x0 0x54000000 0x0 0x54000000 0 0x2000000>,
+			 <0x43000000 0x6 0x80000000 0x6 0x80000000 0 0x80000000>;
+#else
+		ranges = <0x43000000 0x6 0x80000000 0x6 0x80000000 0 0x40000000>,
+			 <0x43000000 0x6 0xc0000000 0x6 0xc0000000 0 0x20000000>,
+			 <0x43000000 0x6 0xe0000000 0x6 0xe0000000 0 0x10000000>,
+			 <0x83000000 0x0 0x40000000 0x6 0xf0000000 0 0x10000000>;
+#endif
+		brcm,pcie-ob;
+		brcm,pcie-ob-axi-offset = <0x00000000>;
+
+		dma-coherent;
+
+		msi-map = <0x000 &gic_its 0x1400 0x400>;
+
+#if (ENABLE_PAXB_IOMMU == 1)
+		iommu-map = <0x000 &smmu 0x1400 0x400>;
+#endif
+
+		phys = <&pcie_phy 5>;
+		phy-names = "pcie-phy";
+
+#if (ENABLE_PCIE5 == 1)
+		status = "okay";
+#else
+		status = "disabled";
+#endif
+	};
+
+	pcie6: pcie@48018000 {
+		compatible = "brcm,iproc-pcie-paxb-v2";
+		reg = <0 0x48018000 0 0x4000>;
+
+		interrupt-controller;
+		#interrupt-cells = <1>;
+		interrupt-map-mask = <0 0 0 7>;
+		interrupt-map = <0 0 0 0 1 &pcie6 1>,
+				<0 0 0 0 2 &pcie6 2>,
+				<0 0 0 0 3 &pcie6 3>,
+				<0 0 0 0 4 &pcie6 4>;
+		interrupts = <GIC_SPI 456 IRQ_TYPE_LEVEL_HIGH>;
+
+		linux,pci-domain = <6>;
+
+		bus-range = <0x0 0xff>;
+
+		#address-cells = <3>;
+		#size-cells = <2>;
+		device_type = "pci";
+#if (ENABLE_32BIT_OUTBOUND == 1)
+		ranges = <0x83000000 0x0 0x5a000000 0x0 0x5a000000 0 0x2000000>,
+			 <0x43000000 0x7 0x00000000 0x7 0x00000000 0 0x80000000>;
+#else
+		ranges = <0x43000000 0x7 0x00000000 0x7 0x00000000 0 0x40000000>,
+			 <0x43000000 0x7 0x40000000 0x7 0x40000000 0 0x20000000>,
+			 <0x43000000 0x7 0x60000000 0x7 0x60000000 0 0x10000000>,
+			 <0x83000000 0x0 0x40000000 0x7 0x70000000 0 0x10000000>;
+#endif
+		brcm,pcie-ob;
+		brcm,pcie-ob-axi-offset = <0x00000000>;
+
+		dma-coherent;
+
+		msi-map = <0x000 &gic_its 0x1800 0x400>;
+
+#if (ENABLE_PAXB_IOMMU == 1)
+		iommu-map = <0x000 &smmu 0x1800 0x400>;
+#endif
+
+		phys = <&pcie_phy 6>;
+		phy-names = "pcie-phy";
+
+#if (ENABLE_PCIE6 == 1)
+		status = "okay";
+#else
+		status = "disabled";
+#endif
+	};
+
+	pcie7: pcie@4801c000 {
+		compatible = "brcm,iproc-pcie-paxb-v2";
+		reg = <0 0x4801c000 0 0x4000>;
+
+		interrupt-controller;
+		#interrupt-cells = <1>;
+		interrupt-map-mask = <0 0 0 7>;
+		interrupt-map = <0 0 0 0 1 &pcie7 1>,
+				<0 0 0 0 2 &pcie7 2>,
+				<0 0 0 0 3 &pcie7 3>,
+				<0 0 0 0 4 &pcie7 4>;
+		interrupts = <GIC_SPI 462 IRQ_TYPE_LEVEL_HIGH>;
+
+		linux,pci-domain = <7>;
+
+		bus-range = <0x0 0xff>;
+
+		#address-cells = <3>;
+		#size-cells = <2>;
+		device_type = "pci";
+#if (ENABLE_32BIT_OUTBOUND == 1)
+		ranges = <0x83000000 0x0 0x5c000000 0x0 0x5c000000 0 0x2000000>,
+			 <0x43000000 0x7 0x80000000 0x7 0x80000000 0 0x80000000>;
+#else
+		ranges = <0x43000000 0x7 0x80000000 0x7 0x80000000 0 0x40000000>,
+			 <0x43000000 0x7 0xc0000000 0x7 0xc0000000 0 0x20000000>,
+			 <0x43000000 0x7 0xd0000000 0x7 0xe0000000 0 0x10000000>,
+			 <0x83000000 0x0 0x40000000 0x7 0xf0000000 0 0x10000000>;
+#endif
+		brcm,pcie-ob;
+		brcm,pcie-ob-axi-offset = <0x00000000>;
+
+		dma-coherent;
+
+		msi-map = <0x000 &gic_its 0x1c00 0x400>;
+
+#if (ENABLE_PAXB_IOMMU == 1)
+		iommu-map = <0x000 &smmu 0x1c00 0x400>;
+#endif
+
+		phys = <&pcie_phy 7>;
+		phy-names = "pcie-phy";
+
+#if (ENABLE_PCIE7 == 1)
+		status = "okay";
+#else
+		status = "disabled";
+#endif
+	};
+
+	pcie8: pcie@60400000 {
+		compatible = "brcm,iproc-pcie-paxc-v2";
+		reg = <0 0x60400000 0 0x1000>;
+		linux,pci-domain = <8>;
+
+		bus-range = <0x0 0x1>;
+
+		#address-cells = <3>;
+		#size-cells = <2>;
+		device_type = "pci";
+		ranges = <0x83000000 0 0x10000000 0 0x10000000 0 0x20000000>;
+
+		dma-coherent;
+
+		msi-map = <0x100 &gic_its 0x2000 0x1>, /* PF0 */
+			  <0x108 &gic_its 0x2040 0x8>, /* PF0-VF0-7 */
+			  <0x101 &gic_its 0x2080 0x1>, /* PF1 */
+			  <0x110 &gic_its 0x20c8 0x8>, /* PF1-VF8-15 */
+			  <0x102 &gic_its 0x2100 0x1>, /* PF2 */
+			  <0x118 &gic_its 0x2150 0x8>, /* PF2-VF16-23 */
+			  <0x103 &gic_its 0x2180 0x1>, /* PF3 */
+			  <0x120 &gic_its 0x21d8 0x8>, /* PF3-VF24-31 */
+			  <0x104 &gic_its 0x2200 0x1>, /* PF4 */
+			  <0x128 &gic_its 0x2260 0x8>, /* PF4-VF32-39 */
+			  <0x105 &gic_its 0x2280 0x1>, /* PF5 */
+			  <0x130 &gic_its 0x22e8 0x8>, /* PF5-VF40-47 */
+			  <0x106 &gic_its 0x2300 0x1>, /* PF6 */
+			  <0x138 &gic_its 0x2370 0x8>, /* PF6-VF48-55 */
+			  <0x107 &gic_its 0x2380 0x1>, /* PF7 */
+			  <0x140 &gic_its 0x23f8 0x8>; /* PF7-VF56-63 */
+
+#if (ENABLE_PAXC_IOMMU == 1)
+		iommu-map = <0x100 &smmu 0x2000 0x1>, /* PF0 */
+			    <0x108 &smmu 0x2040 0x8>, /* PF0-VF0-7 */
+			    <0x101 &smmu 0x2080 0x1>, /* PF1 */
+			    <0x110 &smmu 0x20c8 0x8>, /* PF1-VF8-15 */
+			    <0x102 &smmu 0x2100 0x1>, /* PF2 */
+			    <0x118 &smmu 0x2150 0x8>, /* PF2-VF16-23 */
+			    <0x103 &smmu 0x2180 0x1>, /* PF3 */
+			    <0x120 &smmu 0x21d8 0x8>, /* PF3-VF24-31 */
+			    <0x104 &smmu 0x2200 0x1>, /* PF4 */
+			    <0x128 &smmu 0x2260 0x8>, /* PF4-VF32-39 */
+			    <0x105 &smmu 0x2280 0x1>, /* PF5 */
+			    <0x130 &smmu 0x22e8 0x8>, /* PF5-VF40-47 */
+			    <0x106 &smmu 0x2300 0x1>, /* PF6 */
+			    <0x138 &smmu 0x2370 0x8>, /* PF6-VF48-55 */
+			    <0x107 &smmu 0x2380 0x1>, /* PF7 */
+			    <0x140 &smmu 0x23f8 0x8>; /* PF7-VF56-63 */
+#endif
+
+		phys = <&pcie_phy 8>;
+		phy-names = "pcie-phy";
+
+#if (ENABLE_PAXC == 1)
+		status = "okay";
+#else
+		status = "disabled";
+#endif
+	};

 pcie-ss {
 	compatible = "simple-bus";
--- a/arch/arm64/boot/dts/broadcom/stingray/stingray-pinctrl.dtsi
+++ b/arch/arm64/boot/dts/broadcom/stingray/stingray-pinctrl.dtsi
@@ -42,14 +42,13 @@

 		pinmux: pinmux@14029c {
 			compatible = "pinctrl-single";
-			reg = <0x0014029c 0x26c>;
+			reg = <0x0014029c 0x250>;
 			#address-cells = <1>;
 			#size-cells = <1>;
 			pinctrl-single,register-width = <32>;
 			pinctrl-single,function-mask = <0xf>;
 			pinctrl-single,gpio-range = <
-				&range 0  91 MODE_GPIO
-				&range 95 60 MODE_GPIO
+				&range 0 154 MODE_GPIO
 				>;
 			range: gpio-range {
 				#pinctrl-single,gpio-range-cells = <3>;
